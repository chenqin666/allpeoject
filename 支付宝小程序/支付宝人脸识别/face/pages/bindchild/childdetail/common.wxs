
var getProfile_url = function (url,defaultUrl) {
  // 审批状态0,发起的 1 审批中 2 已撤销 3 已通过 4 已驳回

  if (url == ''||url==null) {
    return defaultUrl;
  }
 
  return url;
}


var getProcessPeopleName = function (name, desc) {
  // 审批状态0,发起的 1 审批中 2 已撤销 3 已通过 4 已驳回

  if (desc == '' || desc == null) {
    return name;
  }
  return name + "(" + desc+")";
}

// 空校验
var checkBlank = function (value) {
  

  if (value == '' || value == null) {
    return true;
  }
  return false;
}
// 空校验
var checkArrayBlank = function (value) {


  if (value == '' || value == null||value=="[]"|value.length==0) {
    return true;
  }
  return false;
}

// 相等校验
var equal = function (value1,value2) {


  if (value1 == value2) {
    return true;
  }
  return false;
}







var formatTime = function (date) {
  var year = date.getFullYear()
  var month = date.getMonth() + 1
  var day = date.getDate()
  var hour = date.getHours()
  var minute = date.getMinutes()
  var second = date.getSeconds()

  return [year, month, day].map(formatNumber).join('-') + ' ' + [hour, minute, second].map(formatNumber).join(':')
}

var formatDate = function (date)  {
  var year = date.getFullYear()
  var month = date.getMonth() + 1
  var day = date.getDate()
  var hour = date.getHours()
  var minute = date.getMinutes()
  var second = date.getSeconds()

  return [year, month, day].map(formatNumber).join('-')
}


var formatDateMonth = function (date){
  var year = date.getFullYear()
  var month = date.getMonth() + 1
  var day = date.getDate()
  var hour = date.getHours()
  var minute = date.getMinutes()
  var second = date.getSeconds()

  return [month, day].map(formatNumber).join('-')
}

var formatLeaveDate = function(date) {
  var year = date.getFullYear()
  var month = date.getMonth() + 7
  var day = date.getDate()
  var hour = date.getHours()
  var minute = date.getMinutes()
  var second = date.getSeconds()

  return [year, month, day].map(formatNumber).join('-')
}




var formatNumber = function (n) {
  n = n.toString()
  return n[1] ? n : '0' + n
}

var stringToYMD = function (fDate)  {
  var strArray = fDate.split(" ");
  var fullDate = strArray[0].split("-");
  var fulltime = strArray[1].split(":");

  if (fullDate[0].indexOf("0") == 0) {
    fullDate[0] = parseInt(fullDate[0].substring(1));
  }

  if (fullDate[1].indexOf("0") == 0) {
    fullDate[1] = parseInt(fullDate[1].substring(1));
  }
  if (fullDate[2].indexOf("0") == 0) {
    fullDate[2] = parseInt(fullDate[2].substring(1));
  }
  if (fulltime[0].indexOf("0") == 0) {
    fulltime[0] = parseInt(fulltime[0].substring(1));
  }
  if (fulltime[1].indexOf("0") == 0) {
    fulltime[1] = parseInt(fulltime[1].substring(1));
  }
  if (fulltime[2].indexOf("0") == 0) {
    fulltime[2] = parseInt(fulltime[2].substring(1));
  }
  return formatDate(getDate(fullDate[0], fullDate[1] - 1, fullDate[2], 0, 0, 0));
}



var stringToDate = function (fDate)  {
  if(!fDate)
  return;
  var strArray = fDate.split(" ");

  var fullDate = strArray[0].split("-");
  var fulltime = strArray[1].split(":");

  if (fullDate[0].indexOf("0") == 0) {
    fullDate[0] = parseInt(fullDate[0].substring(1));
  }

  if (fullDate[1].indexOf("0") == 0) {
    fullDate[1] = parseInt(fullDate[1].substring(1));
  }
  if (fullDate[2].indexOf("0") == 0) {
    fullDate[2] = parseInt(fullDate[2].substring(1));
  }
  if (fulltime[0].indexOf("0") == 0) {
    fulltime[0] = parseInt(fulltime[0].substring(1));
  }
  if (fulltime[1].indexOf("0") == 0) {
    fulltime[1] = parseInt(fulltime[1].substring(1));
  }
  if (fulltime[2].indexOf("0") == 0) {
    fulltime[2] = parseInt(fulltime[2].substring(1));
  }
  var year = formatDate(getDate()).split("-")[0];
  if (year != fullDate[0]) {//不是同一年，直接显示年月日
    return formatDate(getDate(fullDate[0], fullDate[1] - 1, fullDate[2], fulltime[0], fulltime[1], fulltime[2]));
  }

  
  var etime = Date.parse(getDate());
  var stime = Date.parse(getDate(fullDate[0], fullDate[1] - 1, fullDate[2], fulltime[0], fulltime[1], fulltime[2]));

  var usedTime = etime - stime;  //两个时间戳相差的毫秒数
  var days = Math.floor(usedTime / (24 * 3600 * 1000));//天数
  //计算出小时数
  var leave1 = usedTime % (24 * 3600 * 1000);    //计算天数后剩余的毫秒数
  var hours = Math.floor(leave1 / (3600 * 1000));
  //计算相差分钟数
  var leave2 = leave1 % (3600 * 1000);        //计算小时数后剩余的毫秒数
  var minutes = Math.floor(leave2 / (60 * 1000));
  var time = days + "天" + hours + "时" + minutes + "分";

  if (days == 0 && hours == 0 && minutes == 0) {
    return "刚刚";
  }
  if (days == 0 && hours == 0) {
    return minutes + "分钟前";
  }
  if (days == 0) {
    return hours + "小时前";
  }
  if (days == 1) {
    return "昨天";
  }

  return formatDateMonth(getDate(fullDate[0], fullDate[1] - 1, fullDate[2], 0, 0, 0));
} 


module.exports = {
  getProfile_url: getProfile_url,
  getProcessPeopleName: getProcessPeopleName,
  checkBlank: checkBlank,
  equal: equal,


  formatTime: formatTime,
  formatDate: formatDate,
  formatLeaveDate: formatLeaveDate,
  stringToDate: stringToDate,
  formatDateMonth: formatDateMonth,
  stringToYMD: stringToYMD,
};