<!DOCTYPE html>
<html lang="en" xmlns:v-on="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="content-type" content="text/html;charset=gbk">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"/>
    <title>欢迎使用</title>
    <link href="css/reset.css" rel="stylesheet">
    <link href="css/submitfillinfo.css" rel="stylesheet">
    <link href="css/iosSelect.css" rel="stylesheet">

    <script type="text/javascript">
        var w = document.documentElement.clientWidth >= 1024 ? 1024 : document.documentElement.clientWidth;
        document.documentElement.style.fontSize = w / 750 * 100 + 'px';
    </script>
    <style>
        body {
            background-color: #f6f6f6;
        }

        input:-webkit-autofill,
        textarea:-webkit-autofill,
        select:-webkit-autofill {
            -webkit-box-shadow: 0 0 0 1000px white inset;
        }

        [v-cloak] {
            display: none;
        }
    </style>
</head>
<body style="background: #f9f9f9">
<div class="warp" id="warp" v-cloak style="position: relative;height: 100%;width: 100%;">
    <div class="content_box">
        <div class="cell-box">
            <div class="topimg"> 
                <img src="./img/card.png" class="sdf" alt="">
                <div class="hea">
                    <span>
                        <img src="./img/first_1.png" alt="">
                        衡水第十三中学
                    </span>
                    <span>
                        <img src="./img/head.png" alt="" style="width: 0.3rem; height: 0.3rem;">
                        201977543299
                    </span>
                </div>
                <div class="center">
                   <p class="pscen"> ¥<span style="font-size: 0.6rem">120.50</span></p>
                    <span class="footcen">(以上金额由于网络原因可能延迟更新)</span>
                </div>
                <div class="footers" @click="search">
                   <p>有<span style="color: yellow">¥100元</span>未领取</p>
                </div>
            </div>
            <div class="chongzhi">
                <div class="left" @click="leftmoney">
                    <img src="./img/chongzhi.png" alt="">
                    <span>充值</span>
                </div>
                <div class="right" @click="rightmoney">
                    <img src="./img/jiaoyi.png" alt="">
                    <span>交易明细</span>
                </div>
            </div>
        </div>

        <div class="mainall">
            <div class="maintop" @click="realcard">
                <img src="./img/guashi.png" alt="" class="aimg">
                <div class="mainright">
                  <span class="spans">卡挂失</span>
                  <img src="./img/you.png" alt="">
                </div>
            </div>
            <div class="maintop" @click="realpsaaword">
                <img src="./img/xiugai.png" alt="" class="aimg" style=" width: 0.35rem;
                height: 0.4rem;">
                <div class="mainright">
                    <span class="spans">
                            修改密码
                        
                    </span>
                    <img src="./img/you.png" alt="">
                </div>
            </div>
            <div class="maintop" @click="untrying">
                <img src="./img/jiebang.png" alt="" class="aimg">
                <div class="mainright">
                    <span class="spans">
                            解绑一卡通
                        
                    </span>
                    <img src="./img/you.png" alt="">
                </div>
            </div>
        </div>
       
    </div>
    <div class="bottom_box" style="font-size: 0.26rem; color: gray;">
        本系统由
        <a href="http://m.fangao.100eks.com" style="color: #36a7fa;">凡高云校园</a>
         提供技术支持
    </div>
   <div v-if="totip==true" class="totips">
        <p class="p1">解绑校园卡</p>
        <p class="p2">解绑后将无法使用校园卡相关功能!</p>
        <p class="p3">
            <input type="text" name="" id="" placeholder="请输入校园卡密码" v-model="jiebangpass">
        </p>
        <div class="tofooter">
            <span style="border-right: 0.5px solid #dedede;" @click="confirm()">确定</span>
            <span @click="cancel()">取消</span>
        </div>
   </div>
</div>


<script src="js/jquery.min.js"></script>
<script src="js/vue.js"></script>
<script src="js/jquery-md5.js"></script>
<script src="js/config.js"></script>
<script src="js/iosSelect.js"></script>
<script src="js/data.js"></script>
<script src="js/citys.json"></script>
<link rel="stylesheet" href="css/mint-ui.css">



<script src="https://www.promisejs.org/polyfills/promise-6.1.0.js"></script>
<script src="http://gosspublic.alicdn.com/aliyun-oss-sdk-4.3.0.min.js"></script>

<!--<script src="js/aliyun-oss-sdk.min.js"></script>-->
<script src="js/exif.js"></script>

<script src="js/previewImage.min.js"></script>

<script src="js/cropper.js"></script>
<link rel="stylesheet" href="js/cropper.css">

<!-- 引入样式 -->
<link rel="stylesheet" href="https://unpkg.com/mint-ui/lib/style.css">
<!-- 引入组件库 -->
<script src="https://unpkg.com/mint-ui/lib/index.js"></script>

<!--<script language="javascript">-->
<!--//防止页面后退-->
<!--history.pushState(null, null, document.URL);-->
<!--window.addEventListener('popstate', function () {-->
<!--history.pushState(null, null, document.URL);-->
<!--});-->
<!--</script>-->

<script>
    new Vue({
        el: '#warp',
        data: {
            totip:false,//弹框
            jiebangpass:'',//解绑密码
            user:'',
            stepimages: ["img/step_doing.png", "img/step_undo.png", "img/step_undo.png", "img/step_undo.png"],

            originHeight: '',
            screenHeight: '',
            isOriginHeight: true,
			showshuomingbox:false,

        },

        created: function () {
			// this.stu_name= this.getQueryString('stu_name');
        },

        mounted: function () {

            const that = this;
            // if (!sessionStorage.user) {
            //     window.location.href = 'login.html'
            // } else {
            //     this.user = JSON.parse(sessionStorage.user);
            //     $("#warp").css({
            //         "display": "block"
            //     });
            // }
            that.originHeight = document.documentElement.clientHeight;

            window.onresize = function () {
                that.screenHeight = document.documentElement.clientHeight;
                if (that.originHeight - that.screenHeight > 60) { //这里以防万一改了下判断形式，当屏幕高度减少了60px以上时才隐藏footer
                    that.isOriginHeight = false;
                } else {
                    that.isOriginHeight = true;
                }
            }
            that.initEventListener();
        },


        methods: {
            // 充值
            leftmoney(){
                window.location.href = 'recharge.html';
            },
            // 交易明细
            rightmoney(){
                window.location.href = 'details.html';
            },
            // 挂失卡
            realcard(){
                window.location.href = 'losscard.html'
            },
             // 修改密码
            realpsaaword(){
                
                window.location.href = 'changepsd.html'
            },
            // 余款查询
            search(){
                
                window.location.href = 'searchall.html'
            },
            // 解绑一卡通
            untrying(){
                // window.location.href = 'untrying.html'
                this.totip=true
            },
            // 取消弹框
            cancel(){
                this.totip=false
            },
            // 确定弹框
            confirm(){
                // debugger
                if(!this.jiebangpass){
                    this.errorTips('请输入密码');
					return false;
                }
                this.totip=false
            },
            initEventListener: function () {
                document.body.addEventListener('focusout', function () {
                    window.scrollTo(0, 0);
                })
                document.addEventListener('touchstart', touch, false);
                document.addEventListener('touchmove', touch, false);
                document.addEventListener('touchend', touch, false);
                function touch(event) {
                    var event = event || window.event;

                    var oInp = document.getElementById("inp");

                    switch (event.type) {
                        case "touchstart":

                            break;
                        case "touchend":
                            window.scrollTo(0, 0);
                            break;
                        case "touchmove":
                            //                        event.preventDefault();

                            break;
                    }

                }
            },
           
            /*获取参数*/
            getQueryString: function (name) {
                var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)", "i");
                var r = window.location.search.substr(1).match(reg);
                if (r != null) return unescape(r[2]);
                return null;
            },

            isIos: function () {
                var u = navigator.userAgent, app = navigator.appVersion;
                var isAndroid = u.indexOf('Android') > -1 || u.indexOf('Linux') > -1; //android终端或者uc浏览器
                var isiOS = !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/); //ios终端
                if (isAndroid) {
                    return false;
                }
                if (isiOS) {
                    return true;
                }
            },

            /**
             * 提交草稿或者报名
             */
            submit: function (type) {
                var that = this;
                var request = {
                    "mid": that.user.stu_id,
                
                }
                var requesturl = root + fdsmemberupdateinfo;
                that.loadAnimation();
                setTimeout(function () {
                    $.ajax({
                        type: "post",
                        url: requesturl,
                        beforeSend: function (XMLHttpRequest) {
                            that.loading = true;
                            XMLHttpRequest.setRequestHeader("token", that.user.token);
                        },
                        data: {
                            request: JSON.stringify(request)
                        },
                        dataType: "json",
                        success: function (data) {
                            that.loading = false;
                            that.closeAnimation();
                            if (data.code == 0) {
                              
                            }else {
                                that.errorTips(data.msg);
                            }
                        },
                        error: function () {

                            that.closeAnimation();
                            that.errorTips('网络错误,请重试！');
                        }
                    });

                }, 1000)
            },

            errorTips: function (msg) {
                // debugger
                this.$toast(msg)
            },
            loadAnimation: function () {
                this.$indicator.open({
                    spinnerType: 'fading-circle'
                });
            },
            closeAnimation: function () {
                this.$indicator.close();
            }
        }
    })
</script>


</body>
</html>
